<% @title = t('views.admin.contributions.index.title') %>
<%- @javascripts[:collapsible] = true -%>

<% if @contributor -%>
  <div><strong><%= t 'activerecord.options.user.role_name.contributor' %></strong> <%= @contributor.contact.full_name %></div>
<% else -%>
 <p><%= t('views.admin.contributions.p1') %></p>
  <%= render :partial => '/shared/search_form', :locals => { :url => search_admin_contributions_path, :query => @query } %>
<% end -%>

<%= semantic_form_for(@options, :as => :options, :url => options_admin_contributions_path, :html => { :method => 'put' }) do |form| %>
  <%= form.inputs :fields, :class => 'inputs options collapsed' do %>
    <%= form.input :fields, :as => :check_boxes, :collection => contribution_fields, :label => false %>
    <%= form.commit_button %>
  <% end %>
<% end %>

<% @contributions.each_pair do |set, contributions| -%>

  <%- if contributions.present? -%>
    <%= render :partial => 'table', :locals => { :contributions => contributions, :caption => t("views.admin.contributions.index.captions.#{set.to_s}", :total => contributions.total_entries), :fields => @options.fields } %>
  <%- else -%>
    <%- if @query -%>
      <p class="empty-table-notice"><%= t "views.admin.contributions.index.empty.search.#{set.to_s}" %></p>
    <%- else -%>
      <p class="empty-table-notice"><%= t "views.admin.contributions.index.empty.all.#{set.to_s}" %></p>
    <%- end -%>
  <%- end -%>
  
<%- end -%>
