<% provide :title, t('views.statistics.index.title') %>

<div class="section top">
  
  <h2><%= t 'views.statistics.index.contributions.heading' %></h2>
  
  <div class="usage-statistics">
    <h3><%= t 'views.statistics.index.contributions.ugc' %></h3>
    <ul>
      <li><%= t('activerecord.models.contribution').pluralize %>: <%= number_with_delimiter(Contribution.published.count, :delimiter => ',') %></li>
      <li><%= t('activerecord.models.attachment').pluralize %>: <%= number_with_delimiter(Attachment.published.count, :delimiter => ',') %></li>
    </ul>
  </div>
  
  <div class="usage-statistics">
    <h3><%= t 'views.statistics.index.contributions.institutional' %></h3>
    <ul>
      <li><%= t 'views.statistics.index.providers.europeana' %>: <%= number_with_delimiter(count_all_europeana_items, :delimiter => ',') %></li>
      <li><%= t 'views.statistics.index.providers.dpla' %>: <%= number_with_delimiter(count_all_dpla_items, :delimiter => ',') %></li>
      <li><%= t 'views.statistics.index.providers.digitalnz' %>: <%= number_with_delimiter(count_all_digitalnz_items, :delimiter => ',') %></li>
      <li><%= t 'views.statistics.index.providers.trove' %>: <%= number_with_delimiter(count_all_trove_items, :delimiter => ',') %></li>
    </ul>
  </div>
  
  <%- if @results.present? -%>
    
    <h2><%= yield :title %></h2>
    <%- @results.each_pair do |interval, statistics| -%>
    
      <div class="usage-statistics">
        <h3><%= t interval, :scope => "views.statistics.index.intervals" %></h3>
        <% if statistics[:label] %><p><%= statistics[:label] %></p><% end %>
        <ul>
          <li><%= t 'views.statistics.index.metrics.visits' %>: <%= number_with_delimiter(statistics[:visits]) %></li>
          <li><%= t 'views.statistics.index.metrics.avgtimeonsite' %>: <%= distance_of_time_in_words(statistics[:avgTimeOnSite]) %></li>
          <li><%= t 'views.statistics.index.metrics.object_pageviews' %>: <%= number_with_delimiter(statistics[:object_pageviews]) %></li>
          <li><%= t 'views.statistics.index.metrics.europeana_pageviews' %>: <%= number_with_delimiter(statistics[:europeana_pageviews]) %></li>
        </ul>
      </div>
    
    <%- end -%>
    
  <%- else -%>
    <p><%= t 'views.statistics.index.no_results' %></p>
  <%- end -%>
  
</div>
