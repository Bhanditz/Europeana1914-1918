<% @title = t('views.devise.registrations.new.title') %>

  <% if @user.errors.present? %>
    <% flash.now[:alert] = t("flash.users.register.alert") %>
  <% end %>
  
  <div class="action-links">
    <ul>
      <li><%= link_to t('views.links.privacy_policy'), page_path('about/privacy') %></li>
    </ul>
  </div>
  
  <%= semantic_form_for @user, :as => 'user', :url => user_registration_path, :html => { :class => 'devise' } do |form| -%>
    
    <%= form.inputs :personal_details do %>
      <%- form.object.build_contact unless form.object.contact.present? -%>
      <%= form.semantic_fields_for :contact do |contact| %>
        <%= contact.input :full_name %>
        <%= contact.input :postal_code %>
        <%= contact.input :country, :priority_countries => ['AU', 'CA', 'DE', 'GB', 'US'], :include_blank => '' %>
        <%= contact.input :gender, :as => :select, :collection => { t('activerecord.options.contact.gender.female') => 'F', t('activerecord.options.contact.gender.male') => 'M' } %>
        <%= contact.input :age, :as => :select, :collection => %w(0-17 18-24 25-44 45-59 60+) %>
      <% end %>
    <% end %>
    
    <%= form.inputs :account_details do %>
      <%= form.input :email %>
      <%= form.input :password %>
      <%= form.input :password_confirmation %>
    <% end %>
    
    <%= render :partial => 'terms' %>
    <p>(need to add checkbox) I accept the terms & conditions</p>
      
    <%= form.buttons do %>
      <%= redirect_field %>
      <%= form.commit_button %>
      <%= form_cancel_link home_path %>
    <% end %>
    
  <% end -%>
