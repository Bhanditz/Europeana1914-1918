<%

	@javascripts[:images_loaded] = true
	@javascripts[:index] = true
	@javascripts[:carousel] = true
	@javascripts[:readmore] = true
	@title = t 'views.home.heading'
	require 'hpricot'
	
%>
<div class='section top'>

	<%#= render :partial => '/blog_posts/list', :locals => {:blog => 'europeana', :category => 'hero-image',  :limit => 1, :titles => false,  :deblogger => false } %>

<%
  blog_post_entry = blog_posts(:blog => 'europeana', :category => 'hero-image',  :limit => 1, :titles => false,  :deblogger => false)
  heroImgImg   = ''
  if blog_post_entry.present?
    heroImg      = Hpricot( raw blog_post_entry[0].content )
	heroImgImg   = (heroImg/'img').to_html.html_safe 
  end  
%>

	<% doc = Hpricot( render :partial => '/blog_posts/list', :locals => { :blog => 'europeana', :category => 'index-introduction', :titles => true, :deblogger => true } ) %>
	<% docTitle = doc/'h3' %>
	<% (doc/'h3').remove %>


<%
=begin %>
	<h2><%= (doc/'h3').inner_html %></h2>

	<div id='index-featured' class='carousel two-thirds-right'>	
		<ul>
			<%= render :partial => '/blog_posts/list', :locals => { :blog => 'europeana', :category => 'index-featured', :tag => :li, :relocale => true, :deblogger => true } %>
		</ul>
		<div class='carousel-overlay'></div>	
	</div>
<%
=end %>


	<div id='index-featured'>
		<%= render :partial => 'carousel_text_overlay',
			:locals => { 
				:doc => doc/'p:nth(1)',
				:docTitle => docTitle,
				:mobile => false			
			}
		 %>	
		 <%= heroImgImg  %>
		 
	</div>

	<%= render :partial => 'carousel_text_overlay',
		:locals => { 
			:doc => doc,
			:docTitle => docTitle,
			:mobile => true
		}
	 %>




<%
=begin %>
	
	<div id='index-introduction' class='one-third-left'>
		<% (doc/'h3').remove %>
		<%= raw( (doc).to_html ) %>		
		<div id='index-call-to-action'>
			<a href='<%= current_user.role.name == 'guest' ? contributor_dashboard_path : new_contribution_path %>' class='button'><%= t('common.links.add-your-story') %></a><a href='<%= page_path('explore') %>' class='button'><%= t('common.links.explore-the-stories') %></a>
		</div>		
	</div>

<%
=end %>


		
</div>


<div class='section border-top'>
	
	<div id='index-aside' class='one-third-left-boxed box-gradient'>
		
		<%= render :partial => '/blog_posts/list', :locals => { :category => 'index-aside', :titles => true, :deblogger => true } %>
		
	</div>
	
	
	<div id='news-articles'>
	  
		<h2><%= t('common.news') %></h2>
		
			<%# Add :limit => 1 to the locals for here image %>
		
			<div id='index-follow-us'>
				<%= render :partial => '/blog_posts/list', :locals => { :category => 'index-follow-us', :titles => false, :deblogger => true } %>
			</div>
			
			<%= render :partial => '/blog_posts/list', :locals => { :blog => 'europeana', :category => 'news', :tag => :div, :html_class => 'article', :titles => true, :limit => 2, :deblogger => true, :read_more => true } %>
		
	</div>
	
</div>