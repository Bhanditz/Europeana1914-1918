<%
	
	# supporting scripts
	
	script_files = [
		'i18n.js',
		'translations.js',
		'/themes/v2/javascripts/com/jquery/jquery-1.7.1.min.js',
		'/themes/v2/javascripts/js/utils.js',
		'/themes/v2/javascripts/js/console.js'
	]
	
	if @javascripts[:autocomplete]
		script_files.push(
			'/themes/v2/javascripts/com/jquery/plugins/jquery-ui-1.8.20.custom.min.js'
			#'/themes/v2/javascripts/com/jquery/plugins/jquery.ui.core.js',
			#'/themes/v2/javascripts/com/jquery/plugins/jquery.ui.widget.js',
			#'/themes/v2/javascripts/com/jquery/plugins/jquery.ui.position.js',
			#'/themes/v2/javascripts/com/jquery/plugins/jquery.ui.autocomplete.js'
		)
	end
	
	if @javascripts[:carousel]
		script_files.push(
			'/themes/v2/javascripts/com/gmtplusone/rcarousel.js'
		)
	end
	
	if @javascripts[:collapsible]
		script_files.push(
			'/themes/v2/javascripts/com/jquery/plugins/jquery.collapsible.js',
			'/themes/v2/javascripts/eu/europeana/fieldset-buttons.js'
		)
	end
	
	if @javascripts[:gmap_display] || @javascripts[:gmap_locate]
		script_files.push(
			'http://maps.googleapis.com/maps/api/js?&sensor=false&libraries=places&key=' + configuration(:gmap_api_key),
			'/themes/v2/javascripts/com/google/gmap-geo.v3.js'
		)
	end
	
	if @javascripts[:gmap_display]
		script_files.push(
			'/themes/v2/javascripts/com/google/gmap-display.js'
		)
	end
	
	if @javascripts[:gmap_locate]
		script_files.push(
			'/themes/v2/javascripts/com/google/gmap-locate.js'
		)
	end
	
	if @javascripts[:images_loaded]
		script_files.push(
			'/themes/v2/javascripts/com/jquery/plugins/jquery.imagesloaded.min.js'
		)
	end
	
	if @javascripts[:language_other]
		script_files.push(
			'/themes/v2/javascripts/eu/europeana/language-other.js'
		)
	end	
	
	if @javascripts[:lightbox]
		script_files.push(
			'/themes/v2/javascripts/com/jquery/plugins/jquery.prettyphoto.min.js'
		)
	end	
	
	if @javascripts[:masonry]
		script_files.push(
			'/themes/v2/javascripts/com/jquery/plugins/jquery.masonry.min.js'
		)
	end
	
	if @javascripts[:readmore]
		script_files.push(
			'/themes/v2/javascripts/com/gmtplusone/readmore.js'
		)
	end
	
	if @javascripts[:translate]
		script_files.push(
			'/themes/v2/javascripts/js/loader.js',
			'/themes/v2/javascripts/com/microsoft/translator.js',
			'/themes/v2/javascripts/eu/europeana/translation-services.js'
		)
	end
	
	if @javascripts[:truncate]
		script_files.push(
			'/themes/v2/javascripts/com/gmtplusone/truncate.js'
		)
	end
	
	if @javascripts[:uploadify] && configuration(:uploadify)
		script_files.push(
			#'json2',
			'/themes/v2/javascripts/com/jquery/plugins/uploadify/2.1.4/swfobject.js',
			'/themes/v2/javascripts/com/jquery/plugins/uploadify/2.1.4/jquery.uploadify.v2.1.4.min.js',
			'/themes/v2/javascripts/eu/europeana/uploadify.js'
		)
	end
	
	
	
	
	
	# page scripts
	
	if @javascripts[:attachments_new]
		script_files.push(
			'/themes/v2/javascripts/eu/europeana/attachments-new.js',
			'/themes/v2/javascripts/eu/europeana/upload-one-many.js'
		)
	end	
	
	if @javascripts[:attachments_edit]
		script_files.push(
			'/themes/v2/javascripts/eu/europeana/attachments-edit.js',
			'/themes/v2/javascripts/eu/europeana/upload-one-many.js'
		)
	end
	
	if @javascripts[:collection_days]
		script_files.push(
			'/themes/v2/javascripts/eu/europeana/collection-days.js'
		)
	end
	
	if @javascripts[:contributions_edit]
		script_files.push(
			'/themes/v2/javascripts/eu/europeana/contributions-edit.js'
		)
	end
	
	if @javascripts[:contributions_new]
		script_files.push(
			'/themes/v2/javascripts/eu/europeana/contributions-new.js'
		)
	end
	
	if @javascripts[:contributions_show]
		script_files.push(
			'/themes/v2/javascripts/eu/europeana/contributions-show.js'			
		)
	end
	
	if @javascripts[:explore]
		script_files.push(
			'/themes/v2/javascripts/eu/europeana/explore.js'
		)
	end
	
	if @javascripts[:index]
		script_files.push(
			'/themes/v2/javascripts/eu/europeana/index.js'
		)
	end
	
	if @javascripts[:search]
		script_files.push(
			'/themes/v2/javascripts/eu/europeana/search.js'
		)
	end
	
	
	# share-this
	
	script_files.push(
		'//w.sharethis.com/button/buttons.js',
		'/themes/v2/javascripts/com/sharethis/sharethis.js'
	)
	
%>
<script>
var switchTo5x = true;<% 'for share-this' %>
if ( !window.RunCoCo ) { window.RunCoCo = {}; }
RunCoCo.relativeUrlRoot = '<%= configuration(:relative_url_root) %>';
<% if @contribution && @contribution.ready_to_submit? %>RunCoCo.ready_for_submit = true;<% end %>
<% if @javascripts[:translate] %>RunCoCo.bing_translate_key = '28A86FF39138EFE1BC1D9E9E90B8AF5FC9A950E6';<% end %>
<% if @attachment %>RunCoCo.contribution = { title: '<%= @attachment.contribution.title %>', metadata: <%= raw metadata_json(@attachment.contribution) %> };<% end %>
<% if @javascripts[:uploadify] && configuration(:uploadify) %>
RunCoCo.uploadify_settings = { maxUploadSize: <%= configuration(:max_upload_size) %>, fileExt: '<%= uploadify_file_extensions %>', fileDesc: '<%= uploadify_file_desc %>', script: '<%= contribution_attachments_path(@contribution) %>' };
RunCoCo.authenticityToken = '<%= form_authenticity_token if protect_against_forgery? %>';
RunCoCo.sessionKeyName = '<%= session_key_name %>';
RunCoCo.sessionKey = '<%= cookies[session_key_name] %>';	
<% end %>
<% if 'cataloguer' === current_user.role.name %>RunCoCo.cataloguer = true;<% end %>
</script>
<%= javascript_include_tag script_files %>
<%	# need this here because loading I18n will overwrite if value is set before load %>
<script>I18n.locale = '<%= I18n.locale %>';</script>