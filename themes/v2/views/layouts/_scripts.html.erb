<%
	
	# supporting scripts
	
	script_files = [
		'I18n',
		'/themes/v2/javascripts/com/jquery/jquery-1.7.1.min.js'
	]
	
	
	if @javascripts[:uploadify] && configuration(:uploadify)
		script_files.push(
			#'json2',
			'/themes/v2/javascripts/com/jquery/plugins/uploadify/2.1.4/swfobject.js',
			'/themes/v2/javascripts/com/jquery/plugins/uploadify/2.1.4/jquery.uploadify.v2.1.4.min.js'
		)
	end
	
	
	
	# page scripts
	
	if @javascripts[:listing]
		script_files.push(
			'/themes/v2/javascripts/com/jquery/plugins/jquery.masonry.min.js',
			'/themes/v2/javascripts/com/jquery/plugins/jquery.infinitescroll.min.js',
			'/themes/v2/javascripts/eu/europeana/listing.js'
		)
	end
	
	if @javascripts[:index]
		script_files.push(
			#'/themes/v2/javascripts/com/jquery/plugins/jquery.easing.1.3.js',
			'/themes/v2/javascripts/com/gmtplusone/rcarousel.js',
			#'/themes/v2/javascripts/com/jquery/plugins/jquery.elastislide.min.js',
			#'/themes/v2/javascripts/com/jquery/plugins/jquery.infinitescroll.min.js',
			'/themes/v2/javascripts/eu/europeana/index.js'
		)
	end
	
	if @javascripts[:lightbox]
		script_files.push(
			'/themes/v2/javascripts/com/jquery/plugins/jquery.prettyphoto.min.js'
		)
	end
	
	if @javascripts[:contributions_show]
		script_files.push(
			'/themes/v2/javascripts/com/google/gmap-geo.v3.js',
			'/themes/v2/javascripts/com/google/gmap-display.js',
			#'/themes/v2/javascripts/com/jquery/plugins/jquery.elastislide.min.js',
			'/themes/v2/javascripts/com/gmtplusone/rcarousel.js',
			'/themes/v2/javascripts/com/gmtplusone/truncate.js',
			'/themes/v2/javascripts/eu/europeana/contributions-show.js'
		)
	end
	
	if @javascripts[:contributions_edit]
		script_files.push(
			'/themes/v2/javascripts/com/google/gmap-geo.v3.js',
			'/themes/v2/javascripts/com/google/gmap-locate.js',
			'/themes/v2/javascripts/com/jquery/plugins/jquery.collapsible.js',
			'/themes/v2/javascripts/eu/europeana/contributions-edit.js'
		)
	end
	
	if @javascripts[:contributions_new]
		script_files.push(
			'/themes/v2/javascripts/com/jquery/plugins/jquery.collapsible.js',
			'/themes/v2/javascripts/eu/europeana/contributions-new.js'
		)
	end
	
	if @javascripts[:attachments_new]
		script_files.push(
			'/themes/v2/javascripts/com/jquery/plugins/jquery.collapsible.js',
			'/themes/v2/javascripts/eu/europeana/attachments-new.js'
		)
	end
	
	if @javascripts[:collection_days]
		script_files.push(
			'/themes/v2/javascripts/com/jquery/plugins/jquery.elastislide.min.js',
			'/themes/v2/javascripts/eu/europeana/collection-days.js'
		)
	end
	
	if @javascripts[:explore]
		script_files.push(
			#'/themes/v2/javascripts/com/jquery/plugins/jquery.infinitescroll.min.js',
			'/themes/v2/javascripts/com/gmtplusone/rcarousel.js',
			'/themes/v2/javascripts/eu/europeana/explore.js'
		)
	end
	
%>
<script>
	
	if ( !window.RunCoCo ) { window.RunCoCo = {}; }
	RunCoCo.relativeUrlRoot = '<%= configuration(:relative_url_root) %>';
	
<% if @contribution && @contribution.ready_to_submit? %>
	RunCoCo.ready_for_submit = true;
<% end %>

<% if @attachment %>
	RunCoCo.contribution = {
		title: '<%= @attachment.contribution.title %>',
		metadata: <%= raw metadata_json(@attachment.contribution) %>
	};
<% end %>
	
<% if @javascripts[:uploadify] && configuration(:uploadify) %>
	RunCoCo.uploadify = {
		maxUploadSize: <%= configuration(:max_upload_size) %>,
		fileExt: '<%= uploadify_file_extensions %>',
		fileDesc: '<%= uploadify_file_desc %>',
		script: '<%= contribution_attachments_path(@contribution) %>'
	};
	
	RunCoCo.authenticityToken = '<%= form_authenticity_token if protect_against_forgery? %>';
	RunCoCo.sessionKeyName = '<%= session_key_name %>';
	RunCoCo.sessionKey = '<%= cookies[session_key_name] %>';	
<% end %>
	
<% if 'cataloguer' === current_user.role.name %>	
	RunCoCo.cataloguer = true;
<% end %>

</script>

<% if @javascripts[:gmap_display] || @javascripts[:gmap_locate] %>
<script src="http://maps.googleapis.com/maps/api/js?&sensor=false&libraries=places&key=<%= configuration(:gmap_api_key) %>"></script>
<% end %>

<%= javascript_include_tag script_files %>

<% # need this here because loading I18n will overwrite if value is set before load %>
<script>I18n = { locale : '<%= I18n.locale %>' };</script>